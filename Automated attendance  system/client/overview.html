<!doctype html>
<html lang="en" class="h-full">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>e-Haazri Dashboard</title>
        <script src="/_sdk/data_sdk.js"></script>
        <script src="/_sdk/element_sdk.js"></script>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet">
        <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      min-height: 100%;
      background-color: #f7fafc;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    html, body {
      height: 100%;
      overflow-x: hidden;
    }

    #wrapper {
      min-height: 100%;
    }

    .sidebar {
      background-color: #ffffff;
      font-size: 20px;
      width: 280px;
      min-height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      transition: transform 0.3s ease;
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
      overflow-y: auto;
     

    }
    .txt {
        color: #6b7280;
        font-size: 18px;
      }

   

    .sidebar .nav-link {
      padding: 12px 16px;
      border-radius: 8px;
      transition: all 0.3s ease;
      color: #374151;
    }

    .sidebar .nav-link:hover {
      background-color: #f3f4f6;
      color: #0b3d91;
    }

    .main-content {
      margin-left: 280px;
      width: calc(100% - 280px);
      padding: 20px;
      transition: margin-left 0.3s ease, width 0.3s ease;
    }

    .stat-card {
      transition: transform 0.2s, box-shadow 0.2s;
      border: none;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      height: 100%;
      cursor: default;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .stat-card.clickable {
      cursor: pointer;
    }

    .search-box {
      position: relative;
    }

    .search-box i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #6b7280;
    }

    .search-box input {
      padding-left: 45px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
    }

    .mobile-toggle {
      display: none;
      position: fixed;
      top: 15px;
      left: 15px;
      z-index: 1001;
      background-color: #ffffff;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      cursor: pointer;
    }

    .mobile-toggle i {
      font-size: 24px;
      color: #0b3d91;
    }

    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      z-index: 999;
    }

    .overlay.active {
      display: block;
    }

    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(11, 61, 145, 0.3);
      border-radius: 50%;
      border-top-color: #0b3d91;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
    }

    /* Tablet responsiveness (768px - 992px) */
    @media (max-width: 992px) {
      .sidebar {
        width: 250px;
      }

      .main-content {
        margin-left: 250px;
        width: calc(100% - 250px);
        padding: 18px;
      }

      .stat-card {
        margin-bottom: 15px;
      }

      .sidebar h1 {
        font-size: 22px;
      }

      .sidebar .nav-link {
        font-size: 18px;
        padding: 10px 18px;
      }

      h2 {
        font-size: 24px !important;
      }

      .stat-card {
        font-size: 18px !important;
      }
    }

    /* Mobile responsiveness (up to 768px) */
    @media (max-width: 768px) {
      .mobile-toggle {
        display: block;
      }

      .sidebar {
        transform: translateX(-100%);
        width: 280px;
      }

      .sidebar.active {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
        width: 100%;
        padding: 15px;
        padding-top: 70px;
      }

      .sidebar h1 {
        font-size: 22px;
      }

      .sidebar .nav-link {
        font-size: 16px;
      }

      h2 {
        font-size: 22px !important;
      }

      .stat-card p {
        font-size: 16px !important;
      }

      .stat-card i {
        font-size: 2rem !important;
      }

      .search-box {
        margin-top: 15px;
      }

      .d-flex.gap-2 {
        flex-direction: column;
        width: 100%;
      }

      .d-flex.gap-2 button {
        width: 100%;
      }

      .row.mb-4.align-items-center {
        text-align: center;
      }

      .row.mb-4.align-items-center .col-lg-9 {
        text-align: left;
      }

      .toast-container {
        right: 10px;
        top: 70px;
        left: 10px;
      }
    }

    /* Small mobile devices (up to 576px) */
    @media (max-width: 576px) {
      .sidebar {
        width: 260px;
      }

      .sidebar h1 {
        font-size: 20px;
      }

      .sidebar .nav-link {
        font-size: 15px;
        padding: 10px 15px;
      }

      .main-content {
        padding: 12px;
        padding-top: 65px;
      }

      h1 {
        font-size: 1.5rem;
      }

      h2 {
        font-size: 20px !important;
      }

      .stat-card {
        padding: 15px !important;
        font-size: 16px !important;
      }

      .stat-card p {
        font-size: 14px !important;
      }

      .stat-card i {
        font-size: 1.75rem !important;
      }

      .search-box input {
        font-size: 14px;
        padding: 8px;
        padding-left: 40px;
      }

      .search-box i {
        font-size: 14px;
        left: 12px;
      }

      .btn {
        font-size: 14px;
        padding: 8px 16px;
      }

      .card-body {
        padding: 15px;
      }

      .modal-dialog {
        margin: 10px;
      }

      .d-flex.align-items-center.text-muted {
        flex-direction: column;
        align-items: flex-start !important;
        gap: 5px;
      }

      .d-flex.align-items-center.text-muted .text-secondary {
        display: none;
      }
    }

    /* Extra small devices (up to 400px) */
    @media (max-width: 400px) {
      .sidebar {
        width: 240px;
      }

      .stat-card p {
        font-size: 13px !important;
      }

      h2 {
        font-size: 18px !important;
      }
    }
  </style>
        <style>@view-transition { navigation: auto; }</style>
        <script src="https://cdn.tailwindcss.com"
            type="text/javascript"></script>
    </head>
    <body><!-- Mobile Menu Toggle --> <button class="mobile-toggle"
            id="mobileToggle" aria-label="Toggle menu"> <i
                class="bi bi-list"></i> </button> <!-- Overlay for mobile -->
        <div class="overlay" id="overlay"></div><!-- Sidebar -->
        <nav class="text-black p-4 sidebar card" id="sidebar" role="navigation"
            aria-label="Main navigation">
            <h1 class="p-1" style="margin-left: 10px;">e-Haazri</h1>
            <p class="txt" style="margin-left: 10px;">College Dashboard</p><br>
            <hr><br>

            <ul class="nav flex-column">
                <li class="nav-item"><a class="nav-link text-black"
                        href="overview.html"><i
                            class="bi bi-house-door-fill me-2"></i>Overview</a></li>
                <li class="nav-item"><a class="nav-link text-black"
                        href="student.html"><i
                            class="bi bi-people-fill me-2"></i>Students</a></li>
                <li class="nav-item"><a class="nav-link text-black"
                        href="faculty.html"><i
                            class="bi bi-person-badge-fill me-2"></i>Faculty</a></li>
                <li class="nav-item"><a class="nav-link text-black"
                        href="attendance.html"><i
                            class="bi bi-calendar-check-fill me-2"></i>Attendance</a></li>
                <li class="nav-item"><a class="nav-link text-black"
                        href="login.html"><i
                            class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
            </ul>

        </nav>
        <div id="wrapper" style="margin-left: 20px;"> <!-- Main Content -->
            <main class="main-content" >
                <div class="container-fluid" ><!-- Header -->
                    <header class="row mb-4 align-items-center">
                        <div class="col-lg-9 col-md-8 mb-3 mb-lg-0">
                            <h2 class="mb-2"
                                style="color: #000000; font-weight:500;font-size: 30PX;">Jeppiaar Institute of
                                Technology Dashboard</h2>
                            <div class="d-flex align-items-center text-muted"
                                style="font-size: 18px;"><span
                                    class="me-3">Welcome, <strong
                                        id="userName">Admin</strong></span>
                                <span class="text-secondary">|</span></span><span id="currentDate"></span>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-4">
                            <div class="search-box"><i class="bi bi-search"></i>
                                <label for="searchInput"
                                    class="visually-hidden">Search</label>
                                <input type="text"
                                    class="form-control shadow-sm"
                                    placeholder="Search..." id="searchInput">
                            </div>
                        </div>
                    </header><!-- Stats Cards Row 1 --> <br>
                    <div class="row g-3 mb-4">
                        <div class="col-lg-3 col-md-6 col-sm-6">
                            <div
                                class="card stat-card text-center p-3 d-flex flex-row align-items-center">
                                <div class="col-8" style="font-size: 20px;">
                                    <p class="mb-1">Total Students</p>
                                    <p class="fw-bold mb-0"
                                        id="studentCount"><span
                                            class="loading-spinner"></span></p>
                                </div>
                                <div class="col-4" style="color: #0b3d91;"><i
                                        class="bi bi-people display-5"></i>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 col-sm-6">
                            <div
                                class="card stat-card text-center p-3 d-flex flex-row align-items-center">
                                <div class="col-8" style="font-size: 20px;">
                                    <p class="mb-1">Teaching Staff</p>
                                    <p class="fw-bold mb-0"
                                        id="staffCount"><span
                                            class="loading-spinner"></span></p>
                                </div>
                                <div class="col-4" style="color: #0b3d91;"><i
                                        class="bi bi-person-badge display-5"></i>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 col-sm-6">
                            <div
                                class="card stat-card text-center p-3 d-flex flex-row align-items-center">
                                <div class="col-8" style="font-size: 20px;">
                                    <p class="mb-1">Today's Attendance</p>
                                    <p class="fw-bold mb-0"
                                        id="attendancePercent"><span
                                            class="loading-spinner"></span></p>
                                </div>
                                <div class="col-4" style="color: #0b3d91;"><i
                                        class="bi bi-clipboard-check display-5"></i>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 col-sm-6">
                            <div
                                class="card stat-card clickable text-center p-3 d-flex flex-row align-items-center"
                                id="supportCard">
                                <div class="col-8" style="font-size: 20px;">
                                    <p class="mb-1">Support</p>
                                </div>
                                <div class="col-4" style="color: #0b3d91;"><i
                                        class="bi bi-headset display-5"></i>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div><!-- Stats Cards Row 2 --> <br><br>
                    <!-- Attendance Overview -->
                    <section class="card shadow-sm p-4" style="margin-left: 10px;">
                        <div
                            class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-3 gap-3">
                            <h3 class="mb-0 h4">Attendance Overview</h3>
                            <div class="d-flex gap-2 flex-wrap"><button
                                    class="btn btn-light border rounded px-4 py-2 shadow-sm fw-semibold">
                                    <i class="bi bi-calendar-check p-1"></i>This
                                    Week </button> <button
                                    class="btn text-white d-flex align-items-center"
                                    style="background-color: #0b3d91;"
                                    id="exportBtn"> <i
                                        class="bi bi-download me-2"></i> Export
                                </button>
                            </div>
                        </div>
                        <div class="border rounded p-5 text-center text-muted"
                            style="min-height: 200px;"><i
                                class="bi bi-bar-chart display-1 mb-3"></i>
                            <p>Attendance Chart Visualization</p><small>Chart
                                will be displayed here</small>
                        </div>
                    </section>
                </div>
            </main>
        </div><!-- Notice Modal -->
        <div class="modal fade" id="noticeModal" tabindex="-1"
            aria-labelledby="noticeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title fw-bold"
                            id="noticeModalLabel">Notice Board</h5><button
                            type="button" class="btn-close"
                            data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="noticeList" class="mb-3 text-muted">
                            No Information Available
                        </div>
                        <div id="adminSection" style="display:none;"><label
                                for="noticeInput" class="form-label">Type your
                                notice:</label> <textarea id="noticeInput"
                                class="form-control mb-2"
                                placeholder="Type your notice here..."
                                rows="3"></textarea> <button id="sendNotice"
                                class="btn btn-primary">Send Notice</button>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- Support Modal -->
        <div class="modal fade" id="supportModal" tabindex="-1"
            aria-labelledby="supportModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title fw-bold"
                            id="supportModalLabel">Support
                            Information</h5><button type="button"
                            class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h6 class="fw-bold mb-3">JEPPIAAR INSTITUTE OF
                            TECHNOLOGY (AUTONOMOUS)</h6>
                        <p><i class="bi bi-geo-alt-fill me-2 text-primary"></i>
                            Kunnam, TK, Sunguvarchatram, Sriperumbudur</p>
                        <p><i
                                class="bi bi-telephone-fill me-2 text-primary"></i>
                            044-27159000</p>
                        <p><i class="bi bi-envelope-fill me-2 text-primary"></i>
                            office@jeppiaarinstitute.org</p>
                        <p><i class="bi bi-globe me-2 text-primary"></i>Website:
                            <a href="https://www.jeppiaarinstitute.org/"
                                target="_blank"
                                rel="noopener noreferrer">https://www.jeppiaarinstitute.org/</a></p>
                    </div>
                </div>
            </div>
        </div><!-- Logout Confirmation Modal -->
        <div class="modal fade" id="logoutModal" tabindex="-1"
            aria-labelledby="logoutModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="logoutModalLabel">Confirm
                            Logout</h5><button type="button" class="btn-close"
                            data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to logout?
                    </div>
                    <div class="modal-footer"><button type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal">Cancel</button> <button
                            type="button" class="btn btn-primary"
                            id="confirmLogout">Logout</button>
                    </div>
                </div>
            </div>
        </div>
        <script>
    let allData = [];
    const role = "admin";

    // Data SDK Handler
    const dataHandler = {
      onDataChanged(data) {
        allData = data;
        updateDashboard(data);
      }
    };

    // Initialize Data SDK
    async function initializeApp() {
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          console.error("Failed to initialize Data SDK");
        }
      }
    }

    // Update Dashboard with real data
    function updateDashboard(data) {
      const students = data.filter(item => item.type === 'student');
      const staff = data.filter(item => item.type === 'staff');
      const today = new Date().toISOString().split('T')[0];
      const todayAttendance = data.filter(item => item.type === 'attendance' && item.date === today);
      
      const presentCount = todayAttendance.filter(item => item.status === 'present').length;
      const totalAttendance = todayAttendance.length;
      const attendancePercentage = totalAttendance > 0 ? Math.round((presentCount / totalAttendance) * 100) : 0;

      animateCount('studentCount', students.length);
      animateCount('staffCount', staff.length);
      animateCount('attendancePercent', attendancePercentage, true);
    }

    // Animate count
    function animateCount(elementId, target, isPercentage = false) {
      const element = document.getElementById(elementId);
      if (!element) return;
      
      element.innerHTML = '';
      let current = 0;
      const increment = target / 30;
      const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
          element.textContent = isPercentage ? target + '%' : target;
          clearInterval(timer);
        } else {
          element.textContent = isPercentage ? Math.floor(current) + '%' : Math.floor(current);
        }
      }, 30);
    }

    // Display current date
    function displayCurrentDate() {
      const now = new Date();
      const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
      const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
      
      const dayName = days[now.getDay()];
      const day = now.getDate();
      const month = months[now.getMonth()];
      const year = now.getFullYear();
      
      const dateString = `${dayName}, ${day} ${month} ${year}`;
      const dateElement = document.getElementById('currentDate');
      if (dateElement) {
        dateElement.textContent = dateString;
      }
    }

    // Toast notification function
    function showToast(message) {
      let toastContainer = document.getElementById('toastContainer');
      if (!toastContainer) {
        toastContainer = document.createElement('div');
        toastContainer.id = 'toastContainer';
        toastContainer.className = 'toast-container';
        document.body.appendChild(toastContainer);
      }

      const toast = document.createElement('div');
      toast.className = 'alert alert-info alert-dismissible fade show';
      toast.setAttribute('role', 'alert');
      toast.innerHTML = `${message}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>`;
      toastContainer.appendChild(toast);

      setTimeout(() => {
        toast.remove();
      }, 3000);
    }
    // Support Modal
    document.getElementById("supportCard").addEventListener("click", function() {
      const supportModal = new bootstrap.Modal(document.getElementById("supportModal"));
      supportModal.show();
    });

    // Navigation functionality
    document.querySelectorAll('.sidebar .nav-link[data-section]').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const section = this.getAttribute('data-section');
        showToast(`Navigating to ${section.charAt(0).toUpperCase() + section.slice(1)} section`);
        
        // Close mobile menu
        if (window.innerWidth <= 768) {
          document.getElementById('sidebar').classList.remove('active');
          document.getElementById('overlay').classList.remove('active');
        }
      });
    });
         // Set current date
      function updateDate() {
        const now = new Date();

        // Format options
        const options = {
          weekday: "long",
          day: "numeric",
          month: "long",
          year: "numeric",
        };

        // Example: "Tuesday, 9 December 2024"
        const formattedDate = now.toLocaleDateString("en-GB", options);

        const dateElement = document.getElementById("currentDate");
        if (dateElement) {
          dateElement.textContent = formattedDate;
        }
      }

      // Call once on load
      updateDate();

      // Optional: keep updating every hour
      setInterval(updateDate, 1000 * 60 * 60);
    // Logout functionality
    document.getElementById("logoutLink").addEventListener("click", function(e) {
      e.preventDefault();
      const logoutModal = new bootstrap.Modal(document.getElementById("logoutModal"));
      logoutModal.show();
    });

    document.getElementById("confirmLogout").addEventListener("click", function() {
      showToast("Logging out...");
      setTimeout(() => {
        window.location.reload();
      }, 1500);
    });

    // Export functionality
    document.getElementById("exportBtn").addEventListener("click", function() {
      showToast("Exporting attendance data...");
    });

    // Search functionality
    document.getElementById('searchInput').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      if (searchTerm.length > 2) {
        showToast(`Searching for: ${searchTerm}`);
      }
    });

    // Mobile menu toggle functionality
    const mobileToggle = document.getElementById('mobileToggle');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');

    mobileToggle.addEventListener('click', () => {
      sidebar.classList.toggle('active');
      overlay.classList.toggle('active');
    });

    overlay.addEventListener('click', () => {
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
    });

    // Initialize app on load
    window.addEventListener('load', function() {
      initializeApp();
      displayCurrentDate();
    });

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig: {},
        onConfigChange: async (config) => {},
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map()
      });
    }
  </script>
        <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ace597e43a37fe0',t:'MTc2NTU1NDMzNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>